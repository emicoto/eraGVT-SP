;--------------------------------------------------
;ラスボス触手2 天使の樹
;HP75%以上で第一形態、HP50%以上で第二形態、それ以下だと最終形態
;↓触手の存在確認用関数　何も処理しない
@TENTACLE_LASTBOSS_2
;--------------------------------------------------
;名前
@TENTACLE_LASTBOSS_2_GETNAME
IF FLAG:21 == 1
	RESULTS = 天使の樹
ELSEIF FLAG:21 == 2
	RESULTS = 楽園の花
ELSE
	RESULTS = 堕落の核
ENDIF

;--------------------------------------------------
;名前
@TENTACLE_LASTBOSS_2_DEFENITION
IF FLAG:21 == 1
	PRINTFORML （Ｋ触手の死体から生え出してきた巨大な柱状の構造物）
	PRINTFORML （中心につぼみが存在し、遠目からはまるで肉で出来た大樹のようにも見える）
ELSEIF FLAG:21 == 2
	PRINTFORML （天使の樹の中央にある巨大なつぼみが花開いた姿）
	PRINTFORML （周囲の広範囲にわたって虹色にきらめく謎の花粉を飛ばしている）
ELSE
	PRINTFORML （萎れた楽園の花から姿を現した天使の樹の中心核）
	PRINTFORML （周囲の地面からは柱状の触手が突き出てビルを薙ぎ倒している）
ENDIF

;--------------------------------------------------
;HP
@TENTACLE_LASTBOSS_2_HP
LOCAL = 10000
CALL TENTACLE_STATUS_HOSEI, LOCAL,2500
RETURN RESULT

;--------------------------------------------------
;射精限界値
@TENTACLE_LASTBOSS_2_SYASEI
CALL TENTACLE_LEVEL
LOCAL = 580 + RESULT * 10
RETURN LOCAL

;--------------------------------------------------
;搾精ダメージ補正
@TENTACLE_LASTBOSS_2_SAKUSEI
IF FLAG:21 >= 3
	LOCAL = 25
ELSEIF FLAG:21 >= 1
	LOCAL = 50
ENDIF
RETURN LOCAL

;--------------------------------------------------
;油断度閾値
@TENTACLE_LASTBOSS_2_YUDAN
IF FLAG:21 == 1
	LOCAL = 1500
ELSEIF FLAG:21 == 2
	LOCAL = 3000
ELSE
	LOCAL = 6000
ENDIF
RETURN LOCAL

;--------------------------------------------------
;攻撃
@TENTACLE_LASTBOSS_2_KOUGEKI
IF FLAG:21 == 1
	LOCAL = (BASE:防御 - 100) / 6 + 80
	SIF LOCAL < 200
		LOCAL = 200
ELSEIF FLAG:21 == 2
	LOCAL = (BASE:防御 - 100) / 4 + 160
	SIF LOCAL < 250
		LOCAL = 250
ELSE
	LOCAL = (BASE:防御 - 100) / 2 + 200
	SIF LOCAL < 300
		LOCAL = 300
ENDIF
CALL TENTACLE_STATUS_HOSEI, LOCAL,10
RETURN RESULT

;--------------------------------------------------
;防御
@TENTACLE_LASTBOSS_2_BOUGYO
IF FLAG:21 == 1
	LOCAL = (BASE:攻撃 - 100) + 200
	IF TCVAR:0 == 1
		TIMES LOCAL,1.05
		SIF (TFLAG:13 & 1) == 0
			TIMES LOCAL,1.5
	ELSEIF TCVAR:0 == 2
		TIMES LOCAL,0.85
		SIF (TFLAG:13 & 2) == 0
			TIMES LOCAL,2.5
	ELSEIF TCVAR:0 == 3
		TIMES LOCAL,0.75
		SIF (TFLAG:13 & 4) == 0
			TIMES LOCAL,4.5
	ENDIF
ELSEIF FLAG:21 == 2
	LOCAL = (BASE:攻撃 - 100) / 2 + 50
	IF TCVAR:0 == 1
		TIMES LOCAL,1.05
	ELSEIF TCVAR:0 == 2
		TIMES LOCAL,0.85
	ELSEIF TCVAR:0 == 3
		TIMES LOCAL,0.75
	ENDIF
ELSEIF FLAG:21 == 3
	LOCAL = (BASE:攻撃 - 100) / 4 + 50
	IF TCVAR:0 == 1
		TIMES LOCAL,1.05
	ELSEIF TCVAR:0 == 2
		TIMES LOCAL,0.85
	ELSEIF TCVAR:0 == 3
		TIMES LOCAL,0.75
	ENDIF
ELSE
	LOCAL = (BASE:攻撃 - 100) / 4 + 25
	IF TCVAR:0 == 1
		TIMES LOCAL,1.05
	ELSEIF TCVAR:0 == 2
		TIMES LOCAL,0.85
	ELSEIF TCVAR:0 == 3
		TIMES LOCAL,0.75
	ENDIF
ENDIF
CALL TENTACLE_STATUS_HOSEI, LOCAL,25
RETURN RESULT

;--------------------------------------------------
;敏捷
@TENTACLE_LASTBOSS_2_BINSYOU
IF FLAG:21 == 1
	LOCAL = 50
ELSEIF FLAG:21 == 2
	LOCAL = 200
ELSEIF FLAG:21 == 3
	LOCAL = 250
ELSE
	LOCAL = 100
ENDIF
CALL TENTACLE_STATUS_HOSEI, LOCAL
RETURN RESULT

;--------------------------------------------------
;知性
@TENTACLE_LASTBOSS_2_CHISEI
IF FLAG:21 == 1
	LOCAL = 25
ELSEIF FLAG:21 == 2
	LOCAL = 999
ELSE
	LOCAL = 80
ENDIF
CALL TENTACLE_STATUS_HOSEI, LOCAL,10
RETURN RESULT

;--------------------------------------------------
;近距離
@TENTACLE_LASTBOSS_2_SHORT
IF FLAG:21 == 1
	RESULT = 250
ELSEIF FLAG:21 == 2
	RESULT = 150
ELSE
	RESULT = 85
ENDIF
RETURN RESULT

;--------------------------------------------------
;中距離
@TENTACLE_LASTBOSS_2_MIDDLE
IF FLAG:21 == 1
	RESULT = 240
ELSEIF FLAG:21 == 2
	RESULT = 150
ELSE
	RESULT = 85
ENDIF
RETURN RESULT

;--------------------------------------------------
;遠距離
@TENTACLE_LASTBOSS_2_LONG
IF FLAG:21 == 1
	RESULT = 230
ELSEIF FLAG:21 == 2
	RESULT = 150
ELSE
	RESULT = 85
ENDIF
RETURN RESULT

;--------------------------------------------------
;拘束力
@TENTACLE_LASTBOSS_2_HOLD
IF FLAG:21 == 1
	RESULT = 350
ELSEIF FLAG:21 == 2
	RESULT = 140
ELSE
	RESULT = 90
ENDIF
RETURN RESULT

;--------------------------------------------------
;PALAM補正 百分率で返す
@TENTACLE_LASTBOSS_2_PALAM_HOSEI
IF FLAG:21 == 1
	;快C
	LOCAL:0 = 150
	;快V
	LOCAL:1 = 150
	;快A
	LOCAL:2 = 150
	;快B
	LOCAL:3 = 150
	;潤滑
	LOCAL:4 = 100
	;恭順
	LOCAL:5 = 150
	;取得
	LOCAL:6 = 150
	;欲情
	LOCAL:7 = 150
	;屈服
	LOCAL:8 = 50
	;恥辱
	LOCAL:9 = 50
	;苦痛
	LOCAL:10 = 50
	;恐怖
	LOCAL:11 = 50
ELSEIF FLAG:21 == 2
	;快C
	LOCAL:0 = 250
	;快V
	LOCAL:1 = 250
	;快A
	LOCAL:2 = 250
	;快B
	LOCAL:3 = 250
	;潤滑
	LOCAL:4 = 100
	;恭順
	LOCAL:5 = 150
	;取得
	LOCAL:6 = 150
	;欲情
	LOCAL:7 = 150
	;屈服
	LOCAL:8 = 150
	;恥辱
	LOCAL:9 = 150
	;苦痛
	LOCAL:10 = 150
	;恐怖
	LOCAL:11 = 150
ELSE
	;快C
	LOCAL:0 = 100
	;快V
	LOCAL:1 = 100
	;快A
	LOCAL:2 = 100
	;快B
	LOCAL:3 = 100
	;潤滑
	LOCAL:4 = 100
	;恭順
	LOCAL:5 = 50
	;取得
	LOCAL:6 = 50
	;欲情
	LOCAL:7 = 50
	;屈服
	LOCAL:8 = 200
	;恥辱
	LOCAL:9 = 200
	;苦痛
	LOCAL:10 = 200
	;恐怖
	LOCAL:11 = 200
ENDIF

RETURN LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5, LOCAL:6, LOCAL:7, LOCAL:8, LOCAL:9, LOCAL:10, LOCAL:11



;--------------------------------------------------
;専用ルーチン（戦闘）
;第一形態はこちらの体力が残っていれば拘束してこない。
;第二、最終形態は体力と気力の少ない方を狙い撃ちする上に邪悪な波動を使う。
@TENTACLE_LASTBOSS_2_ATTACK_ROUTINE
CALL PERCENT_CAL, BASE:体力, MAXBASE:体力
LOCAL:2 = RESULT
CALL PERCENT_CAL, BASE:気力, MAXBASE:気力
LOCAL:3 = RESULT
IF FLAG:21 == 1
	IF LOCAL:2
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 70
			LOCAL = 1
		ELSE
			LOCAL = 3
		ENDIF
	ELSE
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 70
			LOCAL = 2
		ELSE
			LOCAL = 3
		ENDIF
	ENDIF
ELSEIF LOCAL:2 && LOCAL:3
	IF FLAG:21 >= 3 && RAND:4 == 0
		LOCAL = 2
	ELSEIF LOCAL:2 < LOCAL:3 && LOCAL:2
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 70
			LOCAL = 1
		ELSEIF LOCAL:1 < 80
			LOCAL = 3
		ELSE
			LOCAL = 6
		ENDIF
	ELSEIF LOCAL:2 && (RAND:4 == 0 || FLAG:21 >= 3 && RAND:3 != 0)
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 70
			LOCAL = 1
		ELSEIF LOCAL:1 < 80
			LOCAL = 3
		ELSE
			LOCAL = 6
		ENDIF
	ELSE
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 10
			LOCAL = 3
		ELSE
			LOCAL = 6
		ENDIF
	ENDIF
ELSE
	IF LOCAL:2 <= 0 && LOCAL:3
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 70
			LOCAL = 2
		ELSEIF LOCAL:1 < 80
			LOCAL = 3
		ELSE
			LOCAL = 6
		ENDIF
	ELSEIF LOCAL:3 <= 0 && LOCAL:2
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 70
			LOCAL = 2
		ELSEIF LOCAL:1 < 80
			LOCAL = 1
		ELSE
			LOCAL = 3
		ENDIF
	ELSE
		LOCAL = 2
	ENDIF
ENDIF
RETURN LOCAL

;--------------------------------------------------
;専用ルーチン（性行為）
;第一形態は快楽を与えることを最優先し、キャラに合わせた弱点責めを行う。
;苦痛や羞恥を与えるコマンドは使用しない。

@TENTACLE_LASTBOSS_2_SEX_ROUTINE
CALL PERCENT_CAL, BASE:体力, MAXBASE:体力
LOCAL:2 = RESULT
CALL PERCENT_CAL, BASE:気力, MAXBASE:気力
LOCAL:3 = RESULT
CALL CLEARRANDCHOOSE
IF TALENT:Ｃ敏感 || TALENT:淫核
	FOR LOCAL,0,10
		LOCAL:1 = RAND:100
		IF PALAM:潤滑 < 2000
			LOCAL:10 = 70
			LOCAL:11 = 30
		ELSE
			LOCAL:10 = 20
			LOCAL:11 = 50
		ENDIF
		IF LOCAL:1 < LOCAL:10
			CALL ADDRANDCHOOSE,0
		ELSEIF LOCAL:1 < LOCAL:10 + LOCAL:11
			CALL ADDRANDCHOOSE,1
		ELSE
			CALL ADDRANDCHOOSE,1000
		ENDIF
	NEXT
ENDIF
IF TALENT:Ｖ敏感 || TALENT:淫壷
	FOR LOCAL,0,10
		LOCAL:1 = RAND:100
		IF PALAM:潤滑 < 2000
			LOCAL:10 = 70
			LOCAL:11 = 30
		ELSE
			LOCAL:10 = 20
			LOCAL:11 = 50
		ENDIF
		IF LOCAL:1 < LOCAL:10
			CALL ADDRANDCHOOSE,2
		ELSEIF LOCAL:1 < LOCAL:10 + LOCAL:11
			CALL ADDRANDCHOOSE,3
		ELSE
			CALL ADDRANDCHOOSE,1001
		ENDIF
	NEXT
ENDIF
IF TALENT:Ａ敏感 || TALENT:淫尻
	FOR LOCAL,0,10
		LOCAL:1 = RAND:100
		IF PALAM:潤滑 < 2000
			LOCAL:10 = 70
			LOCAL:11 = 30
		ELSE
			LOCAL:10 = 20
			LOCAL:11 = 50
		ENDIF
		IF LOCAL:1 < LOCAL:10
			CALL ADDRANDCHOOSE,4
		ELSEIF LOCAL:1 < LOCAL:10 + LOCAL:11
			CALL ADDRANDCHOOSE,5
		ELSE
			CALL ADDRANDCHOOSE,1002
		ENDIF
	NEXT
ENDIF
IF TALENT:Ｂ敏感 || TALENT:淫乳
	FOR LOCAL,0,10
		LOCAL:1 = RAND:100
		IF PALAM:潤滑 < 2000
			LOCAL:10 = 70
			LOCAL:11 = 30
		ELSE
			LOCAL:10 = 20
			LOCAL:11 = 50
		ENDIF
		IF LOCAL:1 < LOCAL:10
			CALL ADDRANDCHOOSE,6
		ELSEIF LOCAL:1 < LOCAL:10 + LOCAL:11
			CALL ADDRANDCHOOSE,7
		ELSE
			CALL ADDRANDCHOOSE,1003
		ENDIF
	NEXT
ENDIF
IF FLAG:21 == 1
	IF ABL:自慰中毒
		FOR LOCAL,0,(ABL:自慰中毒 * 3)
			LOCAL:1 = RAND:100
			CALL ADDRANDCHOOSE,1006
		NEXT
	ENDIF
	IF CHOICECOUNT_F() < 100
		FOR LOCAL,0,101 - CHOICECOUNT_F()
			LOCAL:1 = RAND:100
			IF LOCAL:1 < 9
				CALL ADDRANDCHOOSE,0
			ELSEIF LOCAL:1 < 12
				CALL ADDRANDCHOOSE,1
			ELSEIF LOCAL:1 < 21
				CALL ADDRANDCHOOSE,2
			ELSEIF LOCAL:1 < 24
				CALL ADDRANDCHOOSE,3
			ELSEIF LOCAL:1 < 33
				CALL ADDRANDCHOOSE,4
			ELSEIF LOCAL:1 < 36
				CALL ADDRANDCHOOSE,5
			ELSEIF LOCAL:1 < 45
				CALL ADDRANDCHOOSE,6
			ELSEIF LOCAL:1 < 48
				CALL ADDRANDCHOOSE,7
			ELSEIF LOCAL:1 < 55
				CALL ADDRANDCHOOSE,10
			ELSEIF LOCAL:1 < 65
				CALL ADDRANDCHOOSE,11
			ELSEIF LOCAL:1 < 75
				CALL ADDRANDCHOOSE,1000
			ELSEIF LOCAL:1 < 80
				CALL ADDRANDCHOOSE,1001
			ELSEIF LOCAL:1 < 85
				CALL ADDRANDCHOOSE,1002
			ELSEIF LOCAL:1 < 90
				CALL ADDRANDCHOOSE,1003
			ELSEIF LOCAL:1 < 95
				CALL ADDRANDCHOOSE,1005
			ELSE
				CALL ADDRANDCHOOSE,1006
			ENDIF
		NEXT
	ENDIF
ELSE
	IF CHOICECOUNT_F() < 200
		FOR LOCAL,0,101 - CHOICECOUNT_F()
			LOCAL:1 = RAND:100
			IF LOCAL:1 < 8
				CALL ADDRANDCHOOSE,1
			ELSEIF LOCAL:1 < 16
				CALL ADDRANDCHOOSE,3
			ELSEIF LOCAL:1 < 24
				CALL ADDRANDCHOOSE,5
			ELSEIF LOCAL:1 < 32
				CALL ADDRANDCHOOSE,7
			ELSEIF LOCAL:1 < 40
				CALL ADDRANDCHOOSE,8
			ELSEIF LOCAL:1 < 48
				CALL ADDRANDCHOOSE,9
			ELSEIF LOCAL:1 < 52
				CALL ADDRANDCHOOSE,10
			ELSEIF LOCAL:1 < 56
				CALL ADDRANDCHOOSE,11
			ELSEIF LOCAL:1 < 64
				CALL ADDRANDCHOOSE,12
			ELSEIF LOCAL:1 < 68
				CALL ADDRANDCHOOSE,1000
			ELSEIF LOCAL:1 < 72
				CALL ADDRANDCHOOSE,1001
			ELSEIF LOCAL:1 < 76
				CALL ADDRANDCHOOSE,1002
			ELSEIF LOCAL:1 < 80
				CALL ADDRANDCHOOSE,1003
			ELSEIF LOCAL:1 < 92
				CALL ADDRANDCHOOSE,1004
			ELSEIF LOCAL:1 < 96
				CALL ADDRANDCHOOSE,1005
			ELSE
				CALL ADDRANDCHOOSE,1007
			ENDIF
		NEXT
	ENDIF
ENDIF

IF CHOICECOUNT_F()
	RETURN RANDCHOOSE_F()
ELSE
	RETURN -1
ENDIF

;--------------------------------------------------
;性コマンドレファレンス
;ARG=1　素股焦らし成功時の行動指定
;ARG=2　素股焦らし失敗時の行動指定
;ARG=3　フェラチオ誘発時の行動指定
@TENTACLE_LASTBOSS_2_REACTION_REF, ARG = 0
IF ARG == 1
	LOCAL = RAND:6
	IF LOCAL < 2
		RETURN 3
	ELSEIF LOCAL < 4
		RETURN 5
	ELSEIF LOCAL < 5
		RETURN 1001
	ELSE
		RETURN 1002
	ENDIF
ELSEIF ARG == 2
	RETURN 15
ELSEIF ARG == 3
	RETURN 11
ENDIF
RETURN -1

;--------------------------------------------------
;専用ルーチン（幽閉）
@TENTACLE_LASTBOSS_2_PRISON_ROUTINE
LOCAL = RAND:100
IF LOCAL < 5
	CALL PRISON_COMABLE, 100
	RETURN 1
ELSEIF LOCAL < 10
	CALL PRISON_COMABLE, 101
	RETURN 1
ELSEIF LOCAL < 15
	CALL PRISON_COMABLE, 102
	RETURN 1
ELSEIF LOCAL < 20
	CALL PRISON_COMABLE, 103
	RETURN 1
ELSEIF LOCAL < 28
	CALL PRISON_COMABLE, 200
	RETURN 1
ELSEIF LOCAL < 36
	CALL PRISON_COMABLE, 201
	RETURN 1
ELSEIF LOCAL < 44
	CALL PRISON_COMABLE, 300
	RETURN 1
ELSEIF LOCAL < 52
	CALL PRISON_COMABLE, 301
	RETURN 1
ELSEIF LOCAL < 60
	CALL PRISON_COMABLE, 104
	RETURN 1
ELSE
	RETURN 0
ENDIF

;--------------------------------------------------
;触手サイズ補正
;この補正の後に部位ごとの補正が入る
@TENTACLE_LASTBOSS_2_TENTACLE_SIZE,ARG
;C用触手
LOCAL:0 = 40
LOCAL:4 = RAND:7 + 3
;V用触手
LOCAL:1 = 100
LOCAL:5 = RAND:3 + 1
;A用触手
LOCAL:2 = 100
LOCAL:6 = RAND:3 + 1
;B用触手
LOCAL:3 = 90
LOCAL:7 = RAND:4 + 2
RETURN LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5, LOCAL:6, LOCAL:7

