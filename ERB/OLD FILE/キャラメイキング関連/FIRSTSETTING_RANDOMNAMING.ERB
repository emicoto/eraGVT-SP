;----------------------------------------------------------
;
@FIRSTSETTING_RANDOMNAMING_ALL
#DIM LCOUNT,2
#DIM LINE
CALL LB
LINE = LINECOUNT
LOCAL:0 = 8
LOCAL:1 = 8
$INPUT_RESELECT
LOCAL:5 = 0
LOCAL:6 = 0
DO
	SIF LOCAL:5 == 0
		FONTBOLD
	PRINT 　上の句：
	IF LOCAL:0 == 0
		PRINTL マジカル的な単語
	ELSEIF LOCAL:0 == 1
		PRINTL 天体の名前
	ELSEIF LOCAL:0 == 2
		PRINTL 色の名前
	ELSEIF LOCAL:0 == 3
		PRINTL 果物、野菜など植物の名前
	ELSEIF LOCAL:0 == 4
		PRINTL 雑多な英単語
	ELSEIF LOCAL:0 == 5
		PRINTL 宝石の名前
	ELSEIF LOCAL:0 == 6
		PRINTL 人を示す単語
	ELSEIF LOCAL:0 == 7
		PRINTL 武器の名前
	ELSEIF LOCAL:0 == 8
		PRINTL ランダム
	ENDIF
	FONTREGULAR
	SIF LOCAL:5 != 0
		FONTBOLD
	PRINT 　下の句：
	IF LOCAL:1 == 0
		PRINTL マジカル的な単語
	ELSEIF LOCAL:1 == 1
		PRINTL 天体の名前
	ELSEIF LOCAL:1 == 2
		PRINTL 色の名前
	ELSEIF LOCAL:1 == 3
		PRINTL 果物、野菜など植物の名前
	ELSEIF LOCAL:1 == 4
		PRINTL 雑多な英単語
	ELSEIF LOCAL:1 == 5
		PRINTL 宝石の名前
	ELSEIF LOCAL:1 == 6
		PRINTL 人を示す単語
	ELSEIF LOCAL:1 == 7
		PRINTL 武器の名前
	ELSEIF LOCAL:1 == 8
		PRINTL ランダム
	ENDIF
	FONTREGULAR

	IF LOCAL:5 == 0
		PRINT 上
	ELSE
		PRINT 下
	ENDIF
	PRINTL の句のジャンルを選択してください
	PRINTL [ 0] マジカル的な単語
	PRINTL [ 1] 天体の名前
	PRINTL [ 2] 色の名前
	PRINTL [ 3] 果物、野菜など植物の名前
	PRINTL [ 4] 雑多な英単語
	PRINTL [ 5] 宝石の名前
	PRINTL [ 6] 人を示す単語
	PRINTL [ 7] 武器の名前
	PRINTL [ 8] ランダム
	PRINTL [99] もどる
	PRINTL 
	PRINT [100] 
	IF LOCAL:5 == 0
		PRINT 下
	ELSE
		PRINT 上
	ENDIF
	PRINTL の句変更
	PRINTL [200] 生成

	$INPUT_LOOP1
	INPUT
	IF RESULT >= 0 && RESULT <= 8
		LOCAL:(LOCAL:5) = RESULT
		CLEARLINE LINECOUNT - LINE
	ELSEIF RESULT == 99
		RETURN 99
	ELSEIF RESULT == 100
		IF LOCAL:5 == 0
			LOCAL:5 = 1
		ELSE
			LOCAL:5 = 0
		ENDIF
		CLEARLINE LINECOUNT - LINE
	ELSEIF RESULT == 200
		LOCAL:6 = 1
	ELSE
		GOTO INPUT_LOOP1
	ENDIF
LOOP LOCAL:6 < 1

PRINTL 
$INPUT_REGENERATE
FOR LCOUNT:0, 0, 20, 1
	LOCAL:3 = LCOUNT:0
	PRINTFORM [{(LOCAL:3), 2}] 
	FOR LCOUNT:1, 0, 2, 1
		LOCAL:4 = LCOUNT:1
		LOCAL:2 = LOCAL:(LOCAL:4)
		SIF LOCAL:(LOCAL:4) == 8
			LOCAL:(LOCAL:4) = RAND:8
		IF LOCAL:(LOCAL:4) == 0
			;マジカル的な単語
			LOCAL:5 = RAND:50 + 500
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 500
			WEND
			DA:(LOCAL:4):(LOCAL:3) = LOCAL:5
		ELSEIF LOCAL:(LOCAL:4) == 1
			;天体の名前
			LOCAL:5 = RAND:50 + 600
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 600
			WEND
			DA:(LOCAL:4):(LOCAL:3) = LOCAL:5
		ELSEIF LOCAL:(LOCAL:4) == 2
			;色の名前
			LOCAL:5 = RAND:50 + 700
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 700
			WEND
			DA:(LOCAL:4):(LOCAL:3) = LOCAL:5
		ELSEIF LOCAL:(LOCAL:4) == 3
			;果物、野菜など植物の名前
			LOCAL:5 = RAND:50 + 800
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 800
			WEND
			DA:(LOCAL:4):(LOCAL:3) = LOCAL:5
		ELSEIF LOCAL:(LOCAL:4) == 4
			;雑多な英単語
			LOCAL:5 = RAND:50 + 900
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 900
			WEND
			DA:(LOCAL:4):(LOCAL:3) = LOCAL:5
		ELSEIF LOCAL:(LOCAL:4) == 5
			;宝石の名前
			LOCAL:5 = RAND:50 + 1000
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 1000
			WEND
			DA:(LOCAL:4):(LOCAL:3) = LOCAL:5
		ELSEIF LOCAL:(LOCAL:4) == 6
			;人を示す単語
			LOCAL:5 = RAND:50 + 1100
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 1100
			WEND
			DA:(LOCAL:4):(LOCAL:3) = LOCAL:5
		ELSEIF LOCAL:(LOCAL:4) == 7
			;武器の名前
			LOCAL:5 = RAND:50 + 1200
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 1200
			WEND
			DA:(LOCAL:4):(LOCAL:3) = LOCAL:5
		ENDIF
		PRINTFORM %STR:(LOCAL:5)%
		LOCAL:(LOCAL:4) = LOCAL:2
	NEXT
	PRINTL 
NEXT

PRINTL 
PRINTL [100]ジャンルから選びなおす
PRINTL [200]再生成

$INPUT_LOOP2
INPUT
IF RESULT >= 0 && RESULT < 20
	RETURN RESULT
ELSEIF RESULT == 100
	CLEARLINE LINECOUNT - LINE
	GOTO INPUT_RESELECT
ELSEIF RESULT == 200
	CLEARLINE LINECOUNT - LINE
	GOTO INPUT_REGENERATE
ELSE
	GOTO INPUT_LOOP2
ENDIF

;----------------------------------------------------------
;冠名と変身後名のランダム設定
@FIRSTSETTING_RANDOMNAMING, ARG:0, ARG:1, ARGS
PRINTL ジャンルを選択してください
PRINTL [ 0] マジカル的な単語
PRINTL [ 1] 天体の名前
PRINTL [ 2] 色の名前
PRINTL [ 3] 果物、野菜など植物の名前
PRINTL [ 4] 雑多な英単語
PRINTL [ 5] 宝石の名前
PRINTL [ 6] 人を示す単語
PRINTL [ 7] 武器の名前
PRINTL [ 8] ランダム
PRINTL [99] もどる

$INPUT_LOOP
INPUT
LOCAL = RESULT
IF RESULT >= 0 && RESULT <= 8
	;乱数を引数にしているので、ジャンルを増やした場合はRANDを増やすのを忘れずに
	CALL FIRSTSETTING_RANDOMNAMING_SELECT, ARG:0, RESULT, ARG:1, ARGS
ELSEIF RESULT == 99
	RETURN 99,0
ELSE
	GOTO INPUT_LOOP
ENDIF
RESULTS = %RESULTS%
RETURN LOCAL, RESULT

;----------------------------------------------------------
;名称の決定
;冠名(ARG:0 = 0)と変身後名(ARG:0 = 1)共通のテーブル
;ARG:1はジャンル、ARG:2はキャラ番号(変身後名の場合のみ)
@FIRSTSETTING_RANDOMNAMING_SELECT, ARG:0, ARG:1, ARG:2, ARGS
PRINTL 

WHILE 1
	REPEAT 20
		IF ARG:1 == 8
			LOCAL:20 = RAND:8
		ELSE
			LOCAL:20 = ARG:1
		ENDIF

		IF LOCAL:20 == 0
			;マジカル的な単語
			LOCAL:COUNT = RAND:50 + 500
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 500
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 1
			;天体の名前
			LOCAL:COUNT = RAND:50 + 600
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 600
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 2
			;色の名前
			LOCAL:COUNT = RAND:50 + 700
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 700
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 3
			;果物、野菜など植物の名前
			LOCAL:COUNT = RAND:50 + 800
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 800
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 4
			;雑多な英単語
			LOCAL:COUNT = RAND:50 + 900
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 900
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 5
			;宝石の名前
			LOCAL:COUNT = RAND:50 + 1000
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 1000
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 6
			;人を示す単語
			LOCAL:COUNT = RAND:50 + 1100
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 1100
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 7
			;武器の名前
			LOCAL:COUNT = RAND:50 + 1200
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 1200
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ENDIF
	REND

	$RE_OUTPUT

	LOCALS:2 = 
	LOCALS:3 = 
	IF LOCAL:21 == 0
		LOCALS:2 = %ARGS%
	ELSE
		LOCALS:3 = %ARGS%
	ENDIF

	REPEAT 20
		PRINTFORML [{COUNT, 2}] %LOCALS:2%%STR:(LOCAL:COUNT)%%LOCALS:3%
		IF ARG:0
		ELSE
		ENDIF
	REND

	PRINTL 
	PRINT [100] ジャンルから選びなおす
	IF ARGS != ""
		PRINT 　　　　　[800] 
		SIF LOCAL:21 == 0
			FONTBOLD
		PRINTFORM  %ARGS% ＋ 単語 の順
		SIF LOCAL:21 == 0
			FONTREGULAR
	ENDIF
	PRINTL 

	PRINT [200] 再生成
	IF ARGS != ""
		PRINT 　　　　　　　　　　　　　[801] 
		SIF LOCAL:21 == 1
			FONTBOLD
		PRINTFORM  単語 ＋ %ARGS% の順
		SIF LOCAL:21 == 1
			FONTREGULAR
	ENDIF
	PRINTL 

	$INPUT_LOOP3
	INPUT

	IF RESULT >= 0 && RESULT < 20
		RESULTS = %LOCALS:2%%STR:(LOCAL:RESULT)%%LOCALS:3%
		CSTR:(ARG:0):202 = %STR:(LOCAL:RESULT)%
		RETURN 0
	ELSEIF RESULT == 100
		RETURN 1
	ELSEIF RESULT == 200
		CLEARLINE 24
	ELSEIF RESULT == 800
		CLEARLINE 24
		LOCAL:21 = 0
		GOTO RE_OUTPUT
	ELSEIF RESULT == 801
		CLEARLINE 24
		LOCAL:21 = 1
		GOTO RE_OUTPUT
	ELSE
		GOTO INPUT_LOOP3
	ENDIF
WEND

;ARG:0 == 0なら冠名、ARG:0 == 1なら変身後名
IF ARG:0 == 0
	SAVESTR:11 = %LOCALS%
ELSEIF ARG:0 == 1
	CSTR:(ARG:0):203 = %LOCALS%
ENDIF

